{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "PlayerSave",
  "description": "Runtime player save structure for Caelmor v1 and Vertical Slice.",
  "type": "object",

  "properties": {
    "schemaVersion": { "type": "integer", "minimum": 1 },

    "characterId": { "type": "string" },
    "name": { "type": "string" },

    "zoneId": { "type": "string" },

    "position": {
      "type": "object",
      "properties": {
        "x": { "type": "number" },
        "y": { "type": "number" },
        "z": { "type": "number" }
      },
      "required": ["x", "y", "z"]
    },

    "rotationY": { "type": "number", "description": "Top-down/third-person facing angle." },

    "skills": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "skillId": { "type": "string" },
          "level": { "type": "integer", "minimum": 1 },
          "xp": { "type": "number", "minimum": 0 }
        },
        "required": ["skillId", "level", "xp"]
      }
    },

    "inventory": {
      "type": "array",
      "description": "Slot-based inventory; every entry is one slot.",
      "items": {
        "type": "object",
        "properties": {
          "slot": { "type": "integer", "minimum": 0 },
          "itemId": { "type": "string" },
          "quantity": { "type": "integer", "minimum": 1 }
        },
        "required": ["slot", "itemId", "quantity"]
      }
    },

    "equipment": {
      "type": "object",
      "description": "Equipped items in defined equipment slots.",
      "additionalProperties": {
        "type": "object",
        "properties": {
          "itemId": { "type": "string" },
          "durability": { "type": "number" }
        },
        "required": ["itemId"]
      }
    },

    "questProgress": {
      "type": "object",
      "description": "Per-quest player state.",
      "additionalProperties": {
        "type": "object",
        "properties": {
          "state": { "type": "string", "enum": ["not_started", "in_progress", "completed"] },
          "currentObjectiveId": { "type": "string" },
          "flags": {
            "type": "object",
            "additionalProperties": { "type": "boolean" }
          }
        },
        "required": ["state"]
      }
    },

    "activeCraftingJobs": {
      "type": "array",
      "description": "Crafting tasks in progress for VS and v1.",
      "items": {
        "type": "object",
        "properties": {
          "jobId": { "type": "string" },
          "recipeId": { "type": "string" },
          "ticksRemaining": { "type": "integer", "minimum": 0 },
          "stationId": { "type": "string" }
        },
        "required": ["jobId", "recipeId", "ticksRemaining"]
      }
    },

    "learnedRecipes": {
      "type": "array",
      "items": { "type": "string" }
    },

    "currency": {
      "type": "object",
      "properties": {
        "gold": { "type": "integer", "minimum": 0 }
      },
      "required": ["gold"]
    }
  },

  "required": ["schemaVersion", "characterId", "zoneId", "position", "inventory", "skills"]
}
